CREATE DATABASE COLLECTESANG;
USE COLLECTESANG;
DROP TABLE IF EXISTS DONNEUR;
DROP TABLE IF EXISTS DON;
DROP TABLE IF EXISTS COLLECTE;
DROP TABLE IF EXISTS UTILISATEUR;
DROP TABLE IF EXISTS RDV;
DROP TABLE IF EXISTS LIEUCOLLECTE;

CREATE TABLE DONNEUR(
 ID_DONNEUR          INT NOT NULL AUTO_INCREMENT ,
 NUM_ASS_MAL         VARCHAR(14)  NOT NULL,
 NOM                 VARCHAR(14),
 PRENOM              VARCHAR(14),
 DATE_NAISSANCE      VARCHAR(14),
 TEL                 VARCHAR(14),
 EMAIL               VARCHAR(50),
 ADRESSE             VARCHAR(50),  
 POIDS               DECIMAL(11,2),
 GROUPAGE            VARCHAR(10),
 SEXE                ENUM('M', 'F'),
CONSTRAINT DONNEUR_ID_DONNEUR  PRIMARY KEY (ID_DONNEUR));

CREATE TABLE LIEUCOLLECTE (
 ID_LIEU             INT NOT NULL AUTO_INCREMENT,
 NOM                 VARCHAR(20),
 ADRESSE             VARCHAR(50),
 TYPE_LIEU           VARCHAR(14),
CONSTRAINT LIEUCOLLECTE_ID_LIEU  PRIMARY KEY (ID_LIEU));

CREATE TABLE UTILISATEUR(
 ID_UTILISATEUR      INT NOT NULL AUTO_INCREMENT ,
 NOM                 VARCHAR(14),
 PRENOM              VARCHAR(14),
 TEL                 VARCHAR(14),
 EMAIL               VARCHAR(50),
 USERNAME            VARCHAR(30),  
 MOTDEPASSE          VARCHAR(20), 
 NIVEAU              INT,   
CONSTRAINT UTILISATEUR_ID_UTILISATEUR  PRIMARY KEY (ID_UTILISATEUR));

CREATE TABLE COLLECTE (
 ID_COLLECTE         INT NOT NULL AUTO_INCREMENT ,
 ID_LIEU             INT NOT NULL,
 TYPE_COLLECTE       VARCHAR(14),
 DATE_COLLECTE       VARCHAR(14),
 ORGANISATEUR        VARCHAR(20),
CONSTRAINT DON_ID_LIEU FOREIGN KEY (ID_LIEU) REFERENCES LIEUCOLLECTE (ID_LIEU), 
CONSTRAINT COLLECTE_ID_COLLECTE  PRIMARY KEY (ID_COLLECTE));


CREATE TABLE DON (
 ID_DON              INT NOT NULL AUTO_INCREMENT ,
 ID_DONNEUR          INT NOT NULL,
 ID_COLLECTE         INT NOT NULL,
 TYPE_DON            VARCHAR(14),
CONSTRAINT DON_ID_DONNEUR FOREIGN KEY (ID_DONNEUR) REFERENCES DONNEUR (ID_DONNEUR), 
CONSTRAINT DON_ID_COLLECTE FOREIGN KEY (ID_COLLECTE) REFERENCES COLLECTE (ID_COLLECTE), 
CONSTRAINT DON_ID_DON  PRIMARY KEY (ID_DON));

CREATE TABLE RDV (
 ID_RDV              INT NOT NULL AUTO_INCREMENT ,
 ID_DONNEUR          INT NOT NULL,
 ID_UTILISATEUR      INT NOT NULL,
 DATE_RDV            VARCHAR(14),
 HEURE               INT NOT NULL,
 ETAT                ENUM('Annuler','En attente'),  
 
CONSTRAINT RDV_ID_DONNEUR FOREIGN KEY (ID_DONNEUR) REFERENCES DONNEUR (ID_DONNEUR), 
CONSTRAINT RDV_ID_UTILISATEUR FOREIGN KEY (ID_UTILISATEUR) REFERENCES UTILISATEUR (ID_UTILISATEUR),
CONSTRAINT RDV_ID_RDV  PRIMARY KEY (ID_RDV)); 

INSERT INTO DONNEUR VALUES (0,'BOUG666666','Bouhal','Ghiad','25/11/2022','514-358-7430','bouhal_g@hotmail.com','3821 barclay',78.5,'B+','MALE');
INSERT INTO DONNEUR VALUES (0,'RAFM666666','Rafi','Monir','25/11/2022','514-358-7430','rafi_m@hotmail.com','3821 barclay',78.5,'B+','MALE');
INSERT INTO utilisateur VALUES (0,'Bouhal','Ghiad','514-358-7430','bouhal_g@hotmail.com','riad','MALE');
 